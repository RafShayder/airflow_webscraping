mode: "${ENV_MODE}"
logging_level: "${LOGGING_LEVEL}"
#---------------potgress----------------------------------
postgress:
  user: "${POSTGRES_USER}"
  password: "${POSTGRES_PASS}"
  host: "${POSTGRES_HOST}"
  port: "${POSTGRES_PORT}"
  database: "${POSTGRES_DB}"

 #---------------sftp eneria----------------------------------
sftp_energia_c:
  host: "${SFTP_HOST_ENERGIA}"
  port: 22
  username: "${SFTP_USER_ENERGIA}"
  password: "${SFTP_PASS_ENERGIA}"

sftp_energia:
  remote_dir: "/REPORTES_CONSUMOS"
  local_dir: "tmp/sftp_energia"
  specific_filename: "reporte-consumo-energia-PD"
  specific_filename2: "reporte-consumo-energia-DA"
  schema: "RAW"
  table: "SFTP_MM_CONSUMO_SUMINISTRO" # Old not functional
  table_DA: "SFTP_MM_CONSUMO_SUMINISTRO_DA"
  table_PD: "SFTP_MM_CONSUMO_SUMINISTRO_PD"
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  sp_carga: "ods.sp_cargar_sftp_hm_consumo_suministro" #Old not functional
  sp_carga_DA: "ods.sp_cargar_sftp_hm_consumo_suministro_da"
  sp_carga_PD: "ods.sp_cargar_sftp_hm_consumo_suministro_pd"
  errorconfig: {
    schema: "PUBLIC",
    table : "error_energia_ultimo_lote",
    limmit: 100,
    remote_dir: "/daas/dev/energy-facilities/"
  }

#------------Base de sitios-------------------------------------
sftp_daas_c:
  host: "${SFTP_HOST_DAAS}"
  port: 22
  username: "${SFTP_USER_DAAS}"
  password: "${SFTP_PASS_DAAS}"

sftp_base_sitios:
  remote_dir: "/daas/dev/energy-facilities/base-sitios/input"
  local_dir: "tmp/sftp_base_sitios"
  schema: "raw"
  table: "FS_MM_BASE_DE_SITIOS"
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  specific_filename: "BASE_SITIOS"
  sp_carga: "ods.sp_cargar_fs_hm_base_de_sitios"
  
sftp_base_sitios_bitacora:
  remote_dir: "/daas/dev/energy-facilities/base-sitios/input"
  local_dir: "tmp/sftp_base_sitios"
  schema: "RAW"
  table: "FS_MM_BITACORA_BASE_SITIOS"
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  specific_filename: "BASE_SITIOS"
  sp_carga: "ods.sp_cargar_fs_hm_bitacora_base_sitios"


#--------------web indra--------------------------

webindra_energia:
  specific_filename: "recibos_energia_indra.xlsx"
  schema: "raw"
  table: "web_mm_indra_energia"
  local_dir: "tmp/web_indra"
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  errorconfig: {
    schema: "PUBLIC",
    table : "error_energia_ultimo_lote",
    limmit: 100,
    remote_dir: "/daas/dev/energy-facilities/errors"
  }
  BASE_URL: "https://recibosttr.com/sistema"
  LOGIN_PATH: "/"
  EXPORT_TMPL: "/sisReportes/exportarRecibosSpoutConsumo/{start}/{end}"
  USER: "usuario.tdp"
  PASS: "usuario.tdp2021"
  PERIOD_MONTHS: 2
  TIMEOUT: 120
  MAX_RETRIES: 3
  PROXY: "${PROXY}"  # Proxy desde variable de entorno (ej: telefonica01.gp.inet:8080)
  HEADERS: {
            "User-Agent": "Mozilla/5.0",
            "Accept": "*/*",
            "Connection": "keep-alive",
        }
  sp_carga: "ods.sp_cargar_web_hm_indra_energia"

#------Clientes libres-------------------------------------------

clientes_libres:
  local_destination_dir: "tmp/sftp_clientes_libres/processed/clientes_libres.xlsx"
  specific_filename: "F-TELEFONICA"
  remote_dir: "/daas/dev/energy-facilities/recibos-manuales/input/"
  local_dir: "tmp/sftp_clientes_libres"
  schema: "raw"
  table: "sftp_mm_clientes_libres"
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  sp_carga: "ods.sp_cargar_sftp_hm_clientes_libres"

#------Teleows / Integratel Portal-------------------------------------------
teleows:
  # Credenciales del portal (usar variables de entorno o Airflow Connection)
  username: "${TELEOWS_USERNAME}"
  password: "${TELEOWS_PASSWORD}"

  # Configuración general de scraping (compartida por todos los scrapers)
  download_path: "tmp/teleows"
  max_iframe_attempts: 60
  max_status_attempts: 60
  options_to_select: "CM,OPM"
  export_overwrite_files: true
  proxy: "${PROXY}"
  headless: true

#------GDE (Console GDE)-------------------------------------------
gde:
  # Configuración de extracción
  local_dir: "tmp/teleows"
  specific_filename: "Console_GDE_export.xlsx"

  # Configuración de fechas específica para GDE
  date_mode: 2  # 1=rango manual (usa last_n_days si está configurado), 2=último mes automático
  last_n_days: 45  # Últimos N días desde hoy (solo funciona con date_mode=1)

  # Configuración de carga a BD
  schema: "raw"
  table: "web_mm_autin_infogeneral"
  sheet_name: "Export All Custom"  # Nombre de la pestaña en el Excel
  if_exists: "replace"         # 'append' | 'replace' | 'fail'
  page_size: 1000
  chunksize: 10000
  sp_carga: "ods.sp_cargar_gde_tasks"

  # Configuración de errores
  errorconfig:
    schema: "PUBLIC"
    table: "error_gde_ultimo_lote"
    limmit: 100
    remote_dir: "/daas/dev/energy-facilities/gde/errors"

#------Dynamic Checklist (Sub PM Query)-------------------------------------------
dynamic_checklist:
  # Configuración de extracción
  local_dir: "tmp/teleows"
  specific_filename: "DynamicChecklist_SubPM.xlsx"

  # Configuración de fechas específica para Dynamic Checklist
  date_mode: 2  # 1=rango manual (usa last_n_days si está configurado), 2=último mes automático
  last_n_days: 45  # Últimos N días desde hoy (solo funciona con date_mode=1)

  # Configuración de carga a BD
  schema: "raw"
  table: "dynamic_checklist_tasks"
  if_exists: "replace"         # 'append' | 'replace' | 'fail' (mantenido para compatibilidad con otros módulos)
  load_mode: "append"          # Modo específico para dynamic_checklist (siempre append para histórico)
  chunksize: 10000
  sp_carga: "ods.sp_cargar_dynamic_checklist_tasks"

  # Configuración de errores
  errorconfig:
    schema: "PUBLIC"
    table: "error_dynamic_checklist_ultimo_lote"
    limmit: 100
    remote_dir: "/daas/dev/energy-facilities/dynamic_checklist/errors"

